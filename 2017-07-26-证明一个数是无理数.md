# 证明一个数是无理数

当我们谈论一个数是有理数还是无理数的时候，非常自然的认为一些数是无理数了，比如$\sqrt{2}$与$\sqrt{3}$这些，还有$\sqrt{2}^\sqrt{2}$也被认为是显然的无理数。因为我们无法简单地给出一个$\frac p q$使得它们相等。为什么$\sqrt 4$是有理数而其它的不是呢？因为初中生都能明确的给出$2 = \sqrt 4$所以它是一个有理数。但是有一些例子更难考虑，$e^2$，$e^4$，$\pi^2$到底是有理数还是无理数，就是无法一眼看出来的了。故很多时候一个数是有理数还是无理数是难以一眼看出的，要证明一个数是无理数，并不是那么简单的事情。援引一个经典的例子：

## 无法开根的整数

> 证明：$\sqrt 2$是无理数
>
> 设$\sqrt2 = \frac p q$，其中p与q被充分的约去（互质）。于是有$p^2 = 2q^2$说明$p^2$是偶数，易知$p$也是偶数（因为奇数的平方一定是奇数），所以$p^2$是4的倍数，从而得到$q^2$也是偶数，这样$q$也是偶数。这与最开始选择$q$、$p$的条件（互质）相悖。

这一个证明可以扩展一下，偶数考虑的是2，那么对于一般的“非完全平方”的整数（这里非完全平方指的是找不出一个整数平方是它）比如2、3、5、6、7、8、10...这些，可以用类似的方法。先对它们开根，把它们质因数分解，然后提取出质因数中的平方项使得各质因数的次数变为0或者1。最终得到一个数$m$，然后证明：$\sqrt m$是无理数

同样的设$\sqrt m = \frac p q$，其中p与q被充分的约去（互质）。于是有$p^2 = mq^2$说明$p^2$是m的倍数，易知$p$也是$m$的倍数（因为找不到一个整数的平方是$m$所以如果$p$中不含因子$m$那么$p^2$中当然也不含因子m），所以$p^2$是$m^2$的倍数，从而得到$q^2$也是$m$的倍数，这样$q$也是$m$的倍数。这与最开始选择$q$、$p$的条件（互质）相悖。

所以用几乎一样的方法证明了所有无法开根的整数的平方根是无理数。

## 无理数的有理数倍

这个证明太过简单，但还是不妨说出来：

设$m$是一个无理数，$n$是一个有理数，假定$nm$是有理数，那么设$nm = \frac p q$，其中p与q为互质的整数。那么设$n=\frac a b$那么就有$m = \frac {bp} {aq}$那么显而易见m也是有理数，这与m是无理数相悖。

这构成了我们初中、高中数学中见过的无理数的大部分。

## e是一个无理数

### 简单暴力的证法

首先对$e^x$在$x=0$处进行泰勒展开有
$$
e^x = 1+\sum_1^n\frac{x^i}{i!}+\frac{e^{\theta x}x^{n+1}}{(n+1)!} = \sum_0^n\frac{x^i}{i!}+\frac{e^{\theta x}x^{(n+1)}}{(n+1)!}
$$
带入$x=1$有
$$
e = \sum_0^n\frac {1} {i!}+\frac {e^\theta} {(n+1)!}
$$
这可作为e的定义，再设
$$
s_n = \sum_0^n\frac {1} {i!}
$$
于是有
$$
e-s_n=\frac {e^\theta} {(n+1)!} < \frac e {(n+1)!}
$$
设是对收敛速度的一个很好的估计。又设$e=\frac p q$，既假设$e$是一个有理数，那么有
$$
\frac p q - s_q < \frac e {(q+1)!} 
$$
于是两边乘以$q!$就有
$$
(q-1)!p - q!s_q < \frac e {q+1} < 2
$$
很容易看出左边为两个整数相减。这两个整数不可能相等。分类讨论，如果$q>2$成立那么意味着在0到1之间还有一个整数，这是矛盾的。如果$q=2$成立那么左侧式子等于1，可立即得到$e=s_2+1$既$e=3.5$这是明显错误的。

### 更聪明的证法

最后的一段分类讨论是很丑陋的。通过使用对$e$更准确的估计来回避这种讨论。
$$
\begin{align}
e-s_n & = \sum_{n+1}^\infty\frac1{i!}=\frac1{(n+1)!}\left(1+\frac1{n+2}+\cdots\right)\\
&<\frac1{(n+1)!}\left(1+\frac1{n+1}+\left(\frac1{n+1}\right)^2+\cdots\right)\\
&=\frac1{(n+1)!}lim_{x\to\infty}\frac{1-\left(\frac 1 {n+1}\right)^{x+1}}{\frac {n} {n+1}}\\
&=\frac 1 {n!n}
\end{align}
$$
从而在最后直接得到
$$
q!(e-s_q)<\frac 1q
$$
证明e是无理数。

### 更聪明的证法

如果单纯从整数的角度考虑而抛弃分析上对$e$的看法，可能结果会更好。（尝试通过整数=非整数来导出矛盾）但这几种证明最终依据的矛盾是一致的。

定义$e=\sum_0^\infty\frac1{i!}$同时假定它是有理数，那么又设$e=\frac pq$其中$p$与$q$为互质的正整数。

则有式子：
$$
qe=p\\
n!qe=n!p
$$
对$\forall n$恒成立。

那么显而易见等号右边是整数。

这时考虑等号左侧：
$$
\begin{align}
n!qe&=n!q\sum_0^\infty\frac1{i!}\\
&=n!q\left(1+\frac12+\frac16+\dots+\frac1{n!}\right) + q\left(\frac1{n+1}+\frac1{(n+1)(n+2)}+\dots\right)
\end{align}
$$
再加上一个常见的放缩：
$$
\begin {align}
\frac1{n+1}+\frac1{(n+1)(n+2)}+\dots&<\frac1{n+1}+\frac1{(n+1)^2}+\dots\\
&=\frac1n
\end {align}
$$
故由于$q$是一个确定的数，而$n$是任意取得。所以总可以取出一个比$q$大的$n$来确保$n!qe$不是一个整数。

与假设产生矛盾。故$e$是无理数。

## 证明$e^2$是无理数

已知$\alpha$是无理数，与$\alpha^2$是否是无理数之间没有太多关系。比如我们清楚地知道$\sqrt2$是一个无理数但$2$不是。但我们依旧能从$e$是无理数的方法出发，证明出$e^2$也是无理数。重点就在于——估计。

还是套路式的，我们假设$e^2$是有理数并设为$e^2=\frac pq$那么就有一个和上文中类似的式子：
$$
n!qe=n!pe^{-1}
$$
对$\forall n$成立，$对e$与$e^{-1}$进行泰勒展开：
$$
e=\sum_0^\infty\frac1{i!}\\
e^{-1}=\sum_0^\infty\frac{(-1)^i}{i!}
$$
这样的展开式对于估计是非常有利的。考虑到证明$e$是无理数的过程中我们进行的放缩，得出左边比一个整数大“一点点”（这一点点比$\frac q{n}$还要小）

同样的考虑$e^{-1}$有：
$$
\begin{align}
n!e^{-1}&=\sum_0^\infty\frac{(-1)^i}{i!}\\
&=n!\left(1-\frac12+\frac16-\dots+\frac{(-1)^n}{n!}\right) - (-1)^{n}\left(\frac{1}{n+1}-\frac1{(n+1)(n+2)}+\dots\right)\\
\end{align}
$$

这个时候挑选一些好的$n$至关重要（这一系列证明强烈的依赖于$n$的任意性，既然都有任意性了，当然要活用帮助我们的证明）。比如先让n成为一个偶数，这样就分解成了一个整数减去一个小数。我们有意图证明这个小数非常小。

接下来由于
$$
\begin{align}
\frac1{n+1}-\frac1{(n+1)(n+2)}+\dots&<\frac1{n+1}+\frac1{(n+1)(n+2)(n+2)}+\dots\\
&<\frac1n
\end{align}
$$
这个放缩相当粗犷但有效。这有效的证实了右边是一个整数减去一个相当小的小数。但是左侧是一个整数加上一个相当小的小数。这两个小数加起来肯定没有1大，所以得出了矛盾。

所以$e^2$当然也是无理数啦。

## s为一个有理数那么$e^s$是个无理数

在我们一步登天之前，可以先用相当的技巧证明$e^4$是一个无理数，看起来就是对$e^2$的加上技巧的推广。

### 简略的说明$e^4$是一个无理数

和$e^2$情况类似，但是由于继续使用$n!$会使得剩余项（非整数）随着n的增大而增大，我们无法直接保证对于任意大的n那都是一个比1小的小数（实际上我们还希望两个小数加起来比1小）。所以使用一些技巧：区$n$为$2$的一个较大的幂次即令$n=2^m$，此后由[Legendre定理](https://en.wikipedia.org/wiki/Legendre%27s_formula)可知：$\frac {n!}{2^{n-1}}$当且仅当$n=2^m$时为一个整数。用$\frac {n!} {2^{n-1}}$代替$n!$，得到：
$$
q\frac {n!}{2^{n-1}}e^2=p\frac {n!}{2^{n-1}}e^{-2}
$$
由此出发同样收集整数，可得到左侧是比整数大一点，右侧比整数小一点。同样的证得$e^4$是一个无理数。

### 证明$e^s$是个无理数

这里使用的是Niven的方法，用类似的方法可以证明$\pi$是个无理数。首先我们需要一个引理，这个引理介绍了一个多项式的性质：

#### 引理

定义一个工具多项式：
$$
f(x) = \frac {x^n(1-x)^n} {n!}
$$
这个多项式有一些很好的性质需要证明，比如：

1. 函数$f(x)$是个多项式，且形如$f(x)=\frac1{n!}\sum_{i=n}^{2n}c_ix^i$，其系数$c_i$都是整数
2. 当$0<x<1$时，有$0<f(x)<\frac1{n!}$
3. 对所有的$k\geq0$，微分取值$f^{(k)}(0)$和$f^{(k)}(1)$都是整数

不必再赘述它们的证明，因为1、2很容易看出，3可由1直接得到。

#### 证明

只需证明$s$为正整数的情况即可。我们先设$e^{s} = \frac pq$

再定义神秘函数（$s$即为$e$的指数）：
$$
\begin{align}
F(x)&=s^{(2n)}f(x)-s^{2n-1}f^{(1)}(x)+\dots+f^{(2n)}(x)\\
&=s^{(2n)}f(x)-s^{2n-1}f^{(1)}(x)+\dots
\end{align}
$$
先给出这个神秘函数的一些优良性质：

1. $F(1)与F(0)$均为整数。
2. $F^{'}=-sF(x)+s^{2n+1}f(x)$
3. $\frac d {dx}[e^{sx}F(x)]=se^{sx}F(x)+e^{sx}F^{'}(x)=s^{2n+1}e^{sx}f(x)$

其中3是2的直接结论。

然后对$q\int_0^1s^{2n+1}e^{sx}f(x)dx$进行估计，有
$$
q\int_0^1s^{2n+1}e^{sx}f(x)dx=q[e^{sx}F(x)]|_0^1=pF(1)-qF(0)
$$
为一个整数。

又有
$$
q\int_0^1s^{2n+1}e^{sx}f(x)dx<qs^{2n+1}e^s\frac1{n!}=\frac{ps^{2n+1}}{n!}<1
$$
与它是一个整数相悖。

所以$e^s$是一个无理数。

